<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <title>Security-Auswertung OWASP ZAP Report</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            color: #333;
            font-size: 15px;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #2980b9;
            margin-top: 30px;
        }
        h3 {
            color: #34495e;
            margin-top: 25px;
        }
        .summary-box {
            background: #fff;
            border-left: 4px solid #3498db;
            padding: 15px 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px 20px;
            margin: 20px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background: #34495e;
            color: #fff;
            font-weight: 600;
        }
        tr:hover {
            background: #f5f5f5;
        }
        .prio-1 { background: #e74c3c; color: #fff; padding: 3px 8px; border-radius: 3px; font-weight: bold; }
        .prio-2 { background: #e67e22; color: #fff; padding: 3px 8px; border-radius: 3px; font-weight: bold; }
        .prio-3 { background: #f1c40f; color: #333; padding: 3px 8px; border-radius: 3px; font-weight: bold; }
        .prio-4 { background: #3498db; color: #fff; padding: 3px 8px; border-radius: 3px; font-weight: bold; }
        .risk-medium { color: #e67e22; font-weight: bold; }
        .risk-low { color: #f1c40f; font-weight: bold; }
        .risk-info { color: #3498db; font-weight: bold; }
        .finding {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .finding h3 {
            margin-top: 0;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        .section {
            margin: 15px 0;
        }
        .section-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 13px;
        }
        code {
            font-family: "Consolas", "Monaco", monospace;
        }
        ul {
            margin: 10px 0;
            padding-left: 25px;
        }
        li {
            margin: 5px 0;
        }
        .url-example {
            background: #ecf0f1;
            padding: 8px 12px;
            border-radius: 3px;
            font-family: monospace;
            font-size: 13px;
            word-break: break-all;
            margin: 5px 0;
        }
        .next-steps {
            background: #d5edda;
            border-left: 4px solid #28a745;
            padding: 15px 20px;
            margin: 30px 0;
        }
        .next-steps h3 {
            color: #155724;
            margin-top: 0;
        }
    </style>
</head>
<body>

<h1>üîí Security-Auswertung aus OWASP ZAP Report</h1>
<p><strong>Gescannte Seite:</strong> https://saftladen.automatisier.bar<br>
<strong>Scan-Datum:</strong> 26. November 2025</p>

<div class="summary-box">
    <h2 style="margin-top:0;">üìä Zusammenfassung</h2>
    <p><strong>Gesamtbewertung:</strong> Es wurden <strong>6 mittelschwere Probleme</strong> gefunden, die zeitnah behoben werden sollten. Zus√§tzlich gibt es 6 kleinere Probleme (Low) und 6 informative Hinweise.</p>
    <ul>
        <li><span class="risk-medium">Medium:</span> 6 Findings ‚Äì erfordern zeitnahe Aufmerksamkeit</li>
        <li><span class="risk-low">Low:</span> 6 Findings ‚Äì sollten bei Gelegenheit behoben werden</li>
        <li><span class="risk-info">Informational:</span> 6 Findings ‚Äì meist nur zur Kenntnisnahme</li>
    </ul>
</div>

<div class="warning-box">
    <strong>‚ö†Ô∏è Wichtig:</strong> Die mittelschweren Probleme betreffen vor allem falsch konfigurierte Sicherheits-Header und √∂ffentlich zug√§ngliche Backup-Dateien. Diese k√∂nnen von Angreifern ausgenutzt werden, um sensible Informationen zu stehlen oder die Anwendung zu kompromittieren.
</div>

<h2>üìã √úbersicht der Findings</h2>

<table>
    <tr>
        <th>Prio</th>
        <th>Risiko</th>
        <th>Problem</th>
        <th>Kurzbeschreibung</th>
        <th>Betroffene Bereiche</th>
    </tr>
    <tr>
        <td><span class="prio-1">1</span></td>
        <td class="risk-medium">Medium</td>
        <td>Backup-Dateien √∂ffentlich zug√§nglich</td>
        <td>Sicherungskopien von Dateien sind im Web abrufbar</td>
        <td>/ftp/quarantine* (31 Dateien)</td>
    </tr>
    <tr>
        <td><span class="prio-1">2</span></td>
        <td class="risk-medium">Medium</td>
        <td>403-Zugriffssperre umgehbar</td>
        <td>Gesch√ºtzte Bereiche k√∂nnen durch URL-Tricks erreicht werden</td>
        <td>/ftp/*.bak, *.gg, *.pyc (6 URLs)</td>
    </tr>
    <tr>
        <td><span class="prio-2">3</span></td>
        <td class="risk-medium">Medium</td>
        <td>CORS falsch konfiguriert</td>
        <td>Jede fremde Webseite kann Daten von eurer Seite laden</td>
        <td>Gesamte Anwendung</td>
    </tr>
    <tr>
        <td><span class="prio-2">4</span></td>
        <td class="risk-medium">Medium</td>
        <td>CSP-Header fehlt</td>
        <td>Kein Schutz gegen eingeschleuste Skripte (XSS)</td>
        <td>Gesamte Anwendung</td>
    </tr>
    <tr>
        <td><span class="prio-2">5</span></td>
        <td class="risk-medium">Medium</td>
        <td>Proxy-Server erkennbar</td>
        <td>Informationen √ºber die Server-Infrastruktur sind sichtbar</td>
        <td>Gesamte Anwendung</td>
    </tr>
    <tr>
        <td><span class="prio-3">6</span></td>
        <td class="risk-low">Low</td>
        <td>HSTS-Header fehlt</td>
        <td>Browser werden nicht gezwungen, HTTPS zu nutzen</td>
        <td>Gesamte Anwendung</td>
    </tr>
    <tr>
        <td><span class="prio-3">7</span></td>
        <td class="risk-low">Low</td>
        <td>Externe JavaScript-Quellen</td>
        <td>Skripte werden von fremden Servern geladen</td>
        <td>cdnjs.cloudflare.com</td>
    </tr>
    <tr>
        <td><span class="prio-3">8</span></td>
        <td class="risk-low">Low</td>
        <td>Gef√§hrliche JS-Funktionen</td>
        <td>Unsichere Angular-Funktionen im Code</td>
        <td>main.js, vendor.js</td>
    </tr>
    <tr>
        <td><span class="prio-3">9</span></td>
        <td class="risk-low">Low</td>
        <td>Veralteter Feature-Policy Header</td>
        <td>Veraltete Header-Bezeichnung wird verwendet</td>
        <td>Gesamte Anwendung</td>
    </tr>
    <tr>
        <td><span class="prio-3">10</span></td>
        <td class="risk-low">Low</td>
        <td>Spectre-Schutz fehlt</td>
        <td>Cross-Origin-Isolation Headers nicht gesetzt</td>
        <td>Gesamte Anwendung</td>
    </tr>
</table>

<h2>üîç Detaillierte Erkl√§rungen und L√∂sungen</h2>

<!-- Finding 1 -->
<div class="finding">
    <div class="finding-header">
        <h3><span class="prio-1">Prio 1</span> ‚Äì Backup-Dateien √∂ffentlich zug√§nglich</h3>
        <span class="risk-medium">Risiko: Medium</span>
    </div>
    
    <div class="section">
        <div class="section-title">‚ùì Was ist das Problem?</div>
        <p>Der Webserver liefert Sicherungskopien (Backups) von Dateien aus, wenn man nach typischen Backup-Endungen wie <code>.bak</code>, <code>.backup</code>, <code>.old</code>, <code>.zip</code> oder <code>.tar</code> fragt. Auch Kopien mit Namen wie "quarantine - Copy" oder "quarantine~" sind erreichbar.</p>
    </div>
    
    <div class="section">
        <div class="section-title">‚ö†Ô∏è Warum ist das gef√§hrlich?</div>
        <p>Backup-Dateien k√∂nnen sensible Informationen enthalten:</p>
        <ul>
            <li>Quellcode mit Kommentaren und Debug-Informationen</li>
            <li>Konfigurationsdateien mit Passw√∂rtern oder API-Keys</li>
            <li>Alte Versionen mit bekannten Sicherheitsl√ºcken</li>
            <li>Interne Dokumentation oder Gesch√§ftsgeheimnisse</li>
        </ul>
        <p>Ein Angreifer kann diese Dateien einfach herunterladen und analysieren.</p>
    </div>
    
    <div class="section">
        <div class="section-title">üîé Wo wurde das gefunden?</div>
        <p>31 Backup-Dateien im Verzeichnis <code>/ftp/quarantine</code>, zum Beispiel:</p>
        <div class="url-example">https://saftladen.automatisier.bar/ftp/quarantine.bak</div>
        <div class="url-example">https://saftladen.automatisier.bar/ftp/quarantine.zip</div>
        <div class="url-example">https://saftladen.automatisier.bar/ftp/quarantine - Copy</div>
    </div>
    
    <div class="section">
        <div class="section-title">‚úÖ L√∂sung</div>
        <p><strong>Schritt 1:</strong> L√∂sche alle Backup-Dateien vom Webserver:</p>
        <pre><code># Auf dem Server ausf√ºhren:
find /var/www/html -name "*.bak" -delete
find /var/www/html -name "*.backup" -delete
find /var/www/html -name "*.old" -delete
find /var/www/html -name "*~" -delete
find /var/www/html -name "* - Copy*" -delete</code></pre>
        
        <p><strong>Schritt 2:</strong> Blockiere Backup-Dateien in der Webserver-Konfiguration. F√ºr Caddy (wird hier verwendet):</p>
        <pre><code># In der Caddyfile:
@blocked {
    path *.bak *.backup *.old *.swp *.zip *.tar *.jar *.log *~
    path_regexp copy (?i)copy
}
respond @blocked 404</code></pre>
        
        <p><strong>Schritt 3:</strong> Bearbeite Dateien niemals direkt auf dem Produktivserver. Nutze stattdessen ein Versionskontrollsystem (z.B. Git) und ein Deployment-System.</p>
    </div>
</div>

<!-- Finding 2 -->
<div class="finding">
    <div class="finding-header">
        <h3><span class="prio-1">Prio 2</span> ‚Äì 403-Zugriffssperre umgehbar</h3>
        <span class="risk-medium">Risiko: Medium</span>
    </div>
    
    <div class="section">
        <div class="section-title">‚ùì Was ist das Problem?</div>
        <p>Dateien, die eigentlich durch einen 403-Fehler ("Zugriff verboten") gesch√ºtzt sein sollten, k√∂nnen durch einen URL-Trick erreicht werden. Dabei wird <code>/%2e/</code> (das ist ein kodiertes <code>/./</code>) in die URL eingef√ºgt.</p>
    </div>
    
    <div class="section">
        <div class="section-title">‚ö†Ô∏è Warum ist das gef√§hrlich?</div>
        <p>Wenn ihr bewusst bestimmte Dateien gesperrt habt (z.B. sensible Konfigurationsdateien), k√∂nnen Angreifer diese Sperre umgehen und trotzdem auf die Dateien zugreifen. Das macht eure Zugriffskontrolle wirkungslos.</p>
    </div>
    
    <div class="section">
        <div class="section-title">üîé Wo wurde das gefunden?</div>
        <p>6 Dateien im /ftp/ Verzeichnis:</p>
        <div class="url-example">https://saftladen.automatisier.bar/%2e/ftp/coupons_2013.md.bak</div>
        <div class="url-example">https://saftladen.automatisier.bar/%2e/ftp/encrypt.pyc</div>
        <div class="url-example">https://saftladen.automatisier.bar/%2e/ftp/suspicious_errors.yml</div>
    </div>
    
    <div class="section">
        <div class="section-title">‚úÖ L√∂sung</div>
        <p><strong>Schritt 1:</strong> Stelle sicher, dass der Webserver URLs normalisiert, bevor er Zugriffsregeln anwendet. F√ºr Caddy:</p>
        <pre><code># Caddyfile - URL-Normalisierung aktivieren
{
    servers {
        strict_sni_host on
    }
}

# Blockiere kodierte Punkte in Pfaden
@encoded_traversal {
    path_regexp encoded (?i)(%2e|%252e)
}
respond @encoded_traversal 400</code></pre>
        
        <p><strong>Schritt 2:</strong> √úberpr√ºfe, ob die Dateien √ºberhaupt auf dem Server liegen m√ºssen. Sensible Dateien wie <code>.pyc</code> (kompilierter Python-Code) oder <code>.bak</code> sollten gar nicht im Web-Verzeichnis sein.</p>
        
        <p><strong>Schritt 3:</strong> Wenn m√∂glich, nutze eine Whitelist statt einer Blacklist: Erlaube nur bestimmte Dateitypen, anstatt bestimmte zu verbieten.</p>
    </div>
</div>

<!-- Finding 3 -->
<div class="finding">
    <div class="finding-header">
        <h3><span class="prio-2">Prio 3</span> ‚Äì CORS falsch konfiguriert</h3>
        <span class="risk-medium">Risiko: Medium</span>
    </div>
    
    <div class="section">
        <div class="section-title">‚ùì Was ist das Problem?</div>
        <p>CORS (Cross-Origin Resource Sharing) ist ein Sicherheitsmechanismus, der kontrolliert, welche fremden Webseiten auf eure Daten zugreifen d√ºrfen. Euer Server antwortet mit <code>Access-Control-Allow-Origin: *</code> ‚Äì das bedeutet: <strong>jede</strong> Webseite der Welt darf Daten von euch laden.</p>
    </div>
    
    <div class="section">
        <div class="section-title">‚ö†Ô∏è Warum ist das gef√§hrlich?</div>
        <ul>
            <li>Eine b√∂sartige Webseite kann im Hintergrund Anfragen an eure Seite schicken</li>
            <li>Wenn ein Nutzer bei euch eingeloggt ist und dann eine b√∂sartige Seite besucht, k√∂nnte diese Seite Daten von eurem Server abfragen</li>
            <li>Auch wenn Cookies nicht automatisch mitgesendet werden, k√∂nnen √∂ffentliche aber sch√ºtzenswerte Daten (z.B. durch IP-Whitelisting gesch√ºtzt) abgegriffen werden</li>
        </ul>
    </div>
    
    <div class="section">
        <div class="section-title">üîé Wo wurde das gefunden?</div>
        <p>Der Header wird bei allen Antworten gesendet:</p>
        <div class="url-example">Access-Control-Allow-Origin: *</div>
    </div>
    
    <div class="section">
        <div class="section-title">‚úÖ L√∂sung</div>
        <p><strong>Schritt 1:</strong> Entferne den Wildcard-Header und erlaube nur vertrauensw√ºrdige Domains:</p>
        <pre><code># Caddyfile - Nur bestimmte Origins erlauben
header Access-Control-Allow-Origin "https://saftladen.automatisier.bar"

# Oder wenn ihr mehrere Domains braucht:
@cors_allowed {
    header_regexp Origin (?i)^https://(saftladen\.automatisier\.bar|trusted-partner\.com)$
}
header @cors_allowed Access-Control-Allow-Origin "{http.request.header.Origin}"</code></pre>
        
        <p><strong>Schritt 2:</strong> Wenn ihr CORS gar nicht braucht (keine fremden Seiten sollen auf eure API zugreifen), entfernt den Header komplett.</p>
        
        <p><strong>Schritt 3:</strong> Falls ihr CORS mit Credentials (Cookies/Auth) nutzt, setzt zus√§tzlich:</p>
        <pre><code>Access-Control-Allow-Credentials: true
# WICHTIG: Dann darf Allow-Origin NICHT "*" sein!</code></pre>
    </div>
</div>

<!-- Finding 4 -->
<div class="finding">
    <div class="finding-header">
        <h3><span class="prio-2">Prio 4</span> ‚Äì Content Security Policy (CSP) fehlt</h3>
        <span class="risk-medium">Risiko: Medium</span>
    </div>
    
    <div class="section">
        <div class="section-title">‚ùì Was ist das Problem?</div>
        <p>CSP ist wie eine Whitelist f√ºr euren Browser: Sie sagt ihm, von welchen Quellen Skripte, Bilder, Styles usw. geladen werden d√ºrfen. Ohne CSP akzeptiert der Browser alles ‚Äì auch eingeschleusten Schadcode.</p>
    </div>
    
    <div class="section">
        <div class="section-title">‚ö†Ô∏è Warum ist das gef√§hrlich?</div>
        <ul>
            <li><strong>XSS-Angriffe werden einfacher:</strong> Wenn ein Angreifer es schafft, JavaScript in eure Seite einzuschleusen (z.B. √ºber ein Formular), wird es ohne CSP ausgef√ºhrt</li>
            <li><strong>Datendiebstahl:</strong> Eingeschleuster Code kann Cookies, Passw√∂rter oder andere Daten stehlen</li>
            <li><strong>Malware-Verbreitung:</strong> Eure Seite k√∂nnte unbemerkt Schadsoftware von fremden Servern laden</li>
        </ul>
    </div>
    
    <div class="section">
        <div class="section-title">‚úÖ L√∂sung</div>
        <p><strong>Schritt 1:</strong> F√ºge einen CSP-Header hinzu. Hier ein Beispiel f√ºr eine Angular-Anwendung:</p>
        <pre><code># Caddyfile
header Content-Security-Policy "default-src 'self'; script-src 'self' cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' cdnjs.cloudflare.com; img-src 'self' data:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';"</code></pre>
        
        <p><strong>Erkl√§rung der Regeln:</strong></p>
        <ul>
            <li><code>default-src 'self'</code> ‚Äì Standardm√§√üig nur Inhalte von der eigenen Domain erlauben</li>
            <li><code>script-src 'self' cdnjs.cloudflare.com</code> ‚Äì Skripte nur von euch und Cloudflare CDN</li>
            <li><code>frame-ancestors 'none'</code> ‚Äì Verhindert, dass eure Seite in einem iframe eingebettet wird</li>
        </ul>
        
        <p><strong>Schritt 2:</strong> Teste die CSP zuerst im "Report-Only" Modus:</p>
        <pre><code>header Content-Security-Policy-Report-Only "..."</code></pre>
        <p>So seht ihr Verst√∂√üe im Browser-DevTools, ohne dass etwas blockiert wird.</p>
    </div>
</div>

<!-- Finding 5 -->
<div class="finding">
    <div class="finding-header">
        <h3><span class="prio-2">Prio 5</span> ‚Äì Proxy-Server erkennbar</h3>
        <span class="risk-medium">Risiko: Medium</span>
    </div>
    
    <div class="section">
        <div class="section-title">‚ùì Was ist das Problem?</div>
        <p>Durch spezielle HTTP-Methoden (TRACE, OPTIONS) kann ein Angreifer herausfinden, dass ihr Caddy als Reverse Proxy verwendet. Diese Information hilft Angreifern, gezielt nach Schwachstellen in dieser Software zu suchen.</p>
    </div>
    
    <div class="section">
        <div class="section-title">‚ö†Ô∏è Warum ist das gef√§hrlich?</div>
        <ul>
            <li>Angreifer k√∂nnen gezielt nach bekannten Sicherheitsl√ºcken in Caddy suchen</li>
            <li>Die TRACE-Methode kann in bestimmten Szenarien f√ºr "Cross-Site Tracing" Angriffe missbraucht werden</li>
            <li>Je mehr ein Angreifer √ºber eure Infrastruktur wei√ü, desto einfacher kann er angreifen</li>
        </ul>
    </div>
    
    <div class="section">
        <div class="section-title">‚úÖ L√∂sung</div>
        <p><strong>Schritt 1:</strong> Deaktiviere unn√∂tige HTTP-Methoden:</p>
        <pre><code># Caddyfile
@bad_methods {
    method TRACE TRACK
}
respond @bad_methods 405</code></pre>
        
        <p><strong>Schritt 2:</strong> Entferne Server-Informationen aus den Response-Headern (Caddy macht das standardm√§√üig schon gut, aber pr√ºft es):</p>
        <pre><code># Server-Header entfernen, falls vorhanden
header -Server</code></pre>
    </div>
</div>

<!-- Finding 6 -->
<div class="finding">
    <div class="finding-header">
        <h3><span class="prio-3">Prio 6</span> ‚Äì HSTS-Header fehlt</h3>
        <span class="risk-low">Risiko: Low</span>
    </div>
    
    <div class="section">
        <div class="section-title">‚ùì Was ist das Problem?</div>
        <p>HSTS (HTTP Strict Transport Security) sagt dem Browser: "Verbinde dich mit dieser Seite immer nur √ºber HTTPS, niemals √ºber unverschl√ºsseltes HTTP." Ohne diesen Header k√∂nnte ein Angreifer den Nutzer auf eine HTTP-Version umleiten.</p>
    </div>
    
    <div class="section">
        <div class="section-title">‚ö†Ô∏è Warum ist das gef√§hrlich?</div>
        <p>Bei einem "Man-in-the-Middle" Angriff (z.B. in einem √∂ffentlichen WLAN) k√∂nnte ein Angreifer die erste Verbindung abfangen und auf HTTP umleiten. Dann kann er alles mitlesen ‚Äì Passw√∂rter, Session-Cookies, etc.</p>
    </div>
    
    <div class="section">
        <div class="section-title">‚úÖ L√∂sung</div>
        <pre><code># Caddyfile
header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"</code></pre>
        <p><strong>Erkl√§rung:</strong></p>
        <ul>
            <li><code>max-age=31536000</code> ‚Äì Browser merkt sich das 1 Jahr lang</li>
            <li><code>includeSubDomains</code> ‚Äì Gilt auch f√ºr alle Subdomains</li>
            <li><code>preload</code> ‚Äì Erm√∂glicht Aufnahme in die Browser-Preload-Liste</li>
        </ul>
    </div>
</div>

<!-- Finding 7 -->
<div class="finding">
    <div class="finding-header">
        <h3><span class="prio-3">Prio 7</span> ‚Äì Externe JavaScript-Quellen</h3>
        <span class="risk-low">Risiko: Low</span>
    </div>
    
    <div class="section">
        <div class="section-title">‚ùì Was ist das Problem?</div>
        <p>Eure Seite l√§dt JavaScript von <code>cdnjs.cloudflare.com</code> (jQuery und Cookie-Consent). Wenn dieses CDN kompromittiert wird, k√∂nnte Schadcode auf eurer Seite ausgef√ºhrt werden.</p>
    </div>
    
    <div class="section">
        <div class="section-title">‚úÖ L√∂sung</div>
        <p><strong>Option 1:</strong> Nutze Subresource Integrity (SRI) ‚Äì der Browser pr√ºft dann, ob die Datei ver√§ndert wurde:</p>
        <pre><code>&lt;script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"
        integrity="sha384-rY/jv8mMhqDabXSo+UCggqKtdmBfd3qC2/KvyTDNQ6PcUJXaxK1tMepoQda4g5vB"
        crossorigin="anonymous"&gt;&lt;/script&gt;</code></pre>
        
        <p><strong>Option 2:</strong> Hostet die Dateien selbst auf eurem Server. Das ist sicherer, aber ihr m√ºsst sie dann selbst aktuell halten.</p>
    </div>
</div>

<!-- Finding 8 -->
<div class="finding">
    <div class="finding-header">
        <h3><span class="prio-3">Prio 8</span> ‚Äì Gef√§hrliche JS-Funktionen (Angular)</h3>
        <span class="risk-low">Risiko: Low</span>
    </div>
    
    <div class="section">
        <div class="section-title">‚ùì Was ist das Problem?</div>
        <p>Im Code wurde die Funktion <code>bypassSecurityTrustHtml()</code> gefunden. Diese Angular-Funktion umgeht bewusst die eingebaute XSS-Schutzfunktion von Angular.</p>
    </div>
    
    <div class="section">
        <div class="section-title">‚ö†Ô∏è Warum ist das gef√§hrlich?</div>
        <p>Wenn ihr <code>bypassSecurityTrustHtml()</code> mit Benutzereingaben verwendet, kann ein Angreifer Schadcode einschleusen. Angular sch√ºtzt euch normalerweise davor ‚Äì aber mit dieser Funktion schaltet ihr den Schutz ab.</p>
    </div>
    
    <div class="section">
        <div class="section-title">‚úÖ L√∂sung</div>
        <p><strong>Schritt 1:</strong> Sucht im Code nach allen Verwendungen:</p>
        <pre><code>grep -r "bypassSecurityTrust" src/</code></pre>
        
        <p><strong>Schritt 2:</strong> Pr√ºft jeden Fall: Wird hier wirklich vertrauensw√ºrdiger Inhalt verwendet? Wenn Benutzereingaben beteiligt sind, m√ºsst ihr sie vorher serverseitig bereinigen (Sanitization).</p>
        
        <p><strong>Schritt 3:</strong> √úberlegt, ob ihr die Funktion wirklich braucht. Oft gibt es sicherere Alternativen.</p>
    </div>
</div>

<!-- Finding 9+10 kombiniert -->
<div class="finding">
    <div class="finding-header">
        <h3><span class="prio-3">Prio 9-10</span> ‚Äì Weitere Security-Header fehlen</h3>
        <span class="risk-low">Risiko: Low</span>
    </div>
    
    <div class="section">
        <div class="section-title">‚ùì Was fehlt?</div>
        <ul>
            <li><strong>Feature-Policy ‚Üí Permissions-Policy:</strong> Der alte Header-Name wird verwendet</li>
            <li><strong>Cross-Origin-Embedder-Policy (COEP):</strong> Schutz gegen Spectre-Angriffe</li>
            <li><strong>Cross-Origin-Opener-Policy (COOP):</strong> Isolation von Browser-Kontexten</li>
        </ul>
    </div>
    
    <div class="section">
        <div class="section-title">‚úÖ L√∂sung</div>
        <p>F√ºge diese Header zu eurer Caddy-Konfiguration hinzu:</p>
        <pre><code># Caddyfile - Vollst√§ndige Security Header
header {
    # HSTS
    Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    
    # XSS/Injection Schutz
    Content-Security-Policy "default-src 'self'; script-src 'self' cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' cdnjs.cloudflare.com; img-src 'self' data:; font-src 'self'; connect-src 'self'; frame-ancestors 'none';"
    X-Content-Type-Options "nosniff"
    X-Frame-Options "DENY"
    
    # Spectre-Schutz
    Cross-Origin-Embedder-Policy "require-corp"
    Cross-Origin-Opener-Policy "same-origin"
    
    # Permissions (ersetzt Feature-Policy)
    Permissions-Policy "geolocation=(), microphone=(), camera=()"
    
    # Alten Header entfernen
    -Feature-Policy
}</code></pre>
    </div>
</div>

<div class="next-steps">
    <h3>üìù Empfohlene Reihenfolge der Behebung</h3>
    <ol>
        <li><strong>Sofort (heute):</strong> Backup-Dateien vom Server l√∂schen (Prio 1)</li>
        <li><strong>Diese Woche:</strong> CORS richtig konfigurieren und 403-Bypass fixen (Prio 2-3)</li>
        <li><strong>N√§chste Woche:</strong> Alle Security-Header hinzuf√ºgen (Prio 4-6, 9-10)</li>
        <li><strong>Bei Gelegenheit:</strong> Externe Skripte mit SRI absichern, Code-Review f√ºr bypassSecurityTrustHtml (Prio 7-8)</li>
    </ol>
    
    <h3>üîÑ Nach den Fixes</h3>
    <ul>
        <li>F√ºhrt einen erneuten ZAP-Scan durch, um zu pr√ºfen, ob alle Probleme behoben sind</li>
        <li>Testet eure Anwendung gr√ºndlich ‚Äì manche Security-Header k√∂nnen Funktionen beeintr√§chtigen</li>
        <li>Richtet regelm√§√üige automatische Scans ein (z.B. w√∂chentlich)</li>
    </ul>
</div>

<p style="text-align:center; color:#666; margin-top:40px; padding-top:20px; border-top:1px solid #ddd;">
    Diese Auswertung wurde basierend auf dem OWASP ZAP Report vom 26.11.2025 erstellt.<br>
    Bei Fragen wendet euch an euer Security-Team.
</p>

</body>
</html>